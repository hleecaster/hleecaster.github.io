---
title: íŒŒì´ì¬ìœ¼ë¡œ ì—¬ëŸ¬ ê°œì˜ ì—‘ì…€ íŒŒì¼ì—ì„œ í•„ìš”í•œ ê°’ë“¤ë§Œ í•œ ë²ˆì— ê°€ì ¸ì˜¤ê¸°
date: 2019-06-25
categories: [WORK, ğŸ Python]
tags: [Python, Excel, ì—…ë¬´ìë™í™”]
---

íšŒì‚¬ì—ì„œ ì¼ì„ í•˜ë‹¤ ë³´ë©´Â ì—‘ì…€ íŒŒì¼ë¡œ ì‘ì„±ëœ í…œí”Œë¦¿(ì–‘ì‹)ì„ ì—¬ëŸ¬ ì‚¬ëŒì—ê²Œ ë°°í¬í•˜ê³ , ì–‘ì‹ì— ë”°ë¼ ì‘ì„±í•œ ë’¤ ì œì¶œí•˜ë„ë¡ ì•ˆë‚´í•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤. ê·¸ ê²°ê³¼ë¥¼ ìˆ˜ì§‘í•´ì„œ ë³´ë ¤ë©´ íŒŒì¼ì„ í•˜ë‚˜ì”© ì—´ì–´ì„œ ì‚´í´ë´ì•¼ í•˜ëŠ” ë‹¨ìˆœ ë°˜ë³µ ì—…ë¬´ê°€ ë°œìƒí•œë‹¤. ê²Œë‹¤ê°€ ê·¸ë ‡ê²Œ ì‘ì„±ëœ ê°’ë“¤ì„ í•œ ê³³ì— ëª¨ìœ¼ë ¤ë©´ ìˆ˜ê³ ê°€ ì´ë§Œì €ë§Œì´ ì•„ë‹ˆë‹¤.

ë¬¼ë¡  ì¢‹ì€ ì„±ëŠ¥ì˜ PCì™€ ë¹ ë¥¸ ë³µë¶™ì˜ ì†ë†€ë¦¼ì„ ê°€ì¡Œë‹¤ë©´ ì–¼ë§ˆ ì•ˆ ë˜ëŠ” ì–‘ì€ ê¸ˆë°© í•´ê²°í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ ë§Œì•½ ê·¸ ì–‘ì´ ë°©ëŒ€í•˜ë‹¤ë©´ ì–´ë–»ê²Œ í•´ê²°í•˜ëŠ” ê²Œ ì¢‹ì„ê¹Œ?

ê·¸ë˜ì„œÂ íŒŒì´ì¬ìœ¼ë¡œ ë™ì¼í•œ ì–‘ì‹ì˜ ì—‘ì…€íŒŒì¼ì—ì„œ í•„ìš”í•œ ê°’ë§Œ ê¸ì–´ ëª¨ì•„ ìƒˆë¡œìš´ ì—‘ì…€íŒŒì¼ë¡œ ì €ì¥í•˜ëŠ” ì½”ë“œë¥¼ ì§œë³´ì•˜ë‹¤. ë‚˜ëŠ” ì´ ê³¼ì •ì„ â€˜ì—‘ì…€ í¬ë¡¤ë§â€˜ì´ë¼ê³  ë¶€ë¥´ê¸°ë¡œ í•˜ê² ë‹¤. ì´ëŸ° ì‘ì—…ì„ ì¼ì»«ëŠ” êµ¬ì²´ì ì¸ í‘œí˜„ì´ ìˆëŠ”ì§€ëŠ” ëª¨ë¥´ê² ì§€ë§Œ, ì–´ì¨Œë“ Â ì—¬ëŸ¬ ì—‘ì…€ íŒŒì¼ì—ì„œ ê°’ì„ ê¸ì–´ì˜¨ë‹¤ëŠ” ì˜ë¯¸ë¡œ ê·¸ë ‡ê²Œ ë¶€ë¥´ê¸°ë¡œ í•œë‹¤.

ì´ì œ ë‹¨ê³„ë³„ë¡œ í•˜ë‚˜ì”© ë”°ë¼í•´ë³´ì.

## 1. ì—‘ì…€ íŒŒì¼ì„ í•œ ê³³ì— ëª¨ìœ¼ê³  ê³µí†µëœ ì–‘ì‹ì„ í™•ì¸í•œë‹¤.

ë³¸ ì˜ˆì œì— ì‚¬ìš©í•˜ê¸° ìœ„í•´ í”„ë¡œì íŠ¸ í´ë” ì•ˆì— `files`ë¼ëŠ” í•˜ìœ„í´ë”ë¥¼ ìƒì„±í•˜ì—¬ ê·¸ ì•ˆì— `a.xlsx`, `b.xlsx`, `c.xlsx`,ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ê°ê° ì—‘ì…€íŒŒì¼ì„ ë§Œë“¤ì—ˆë‹¤.

ê·¸ë¦¬ê³  ê° ì—‘ì…€ íŒŒì¼ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ íŒŒì¼ë§ˆë‹¤ ë‹¤ë¥¸ ê°’ì´ ì…ë ¥ë˜ì–´ ìˆë‹¤. (B1ì—ëŠ” ì´ë¦„, B2ì—ëŠ” ì„±ë³„, D1ì—ëŠ” ì§ì—…, D2ì—ëŠ” ë‚˜ì´)

> `a.xlsx`
> 
> | |`A`|`B`|`C`|`D`|
> |---|---|---|---|---|
> |`1`|ì´ë¦„|ë°°íŠ¸ë§¨|ì§ì—…|ë°±ìˆ˜|
> |`2`|ì„±ë³„|ë‚¨ì„±|ë‚˜ì´|23|

> `b.xlsx`
> 
> | |`A`|`B`|`C`|`D`|
> |---|---|---|---|---|
> |`1`|ì´ë¦„|ì—‘ìŠ¤ë§¨|ì§ì—…|ì‹¸ì›€ê¾¼|
> |`2`|ì„±ë³„|ë‚¨ì„±|ë‚˜ì´|38|

> `c.xlsx`
> 
> | |`A`|`B`|`C`|`D`|
> |---|---|---|---|---|
> |`1`|ì´ë¦„|ìŠˆí¼ë§¨|ì§ì—…|ì˜ì›…|
> |`2`|ì„±ë³„|ë‚¨ì„±|ë‚˜ì´|32|

ì´ ì‘ì—…ì˜ ëª©í‘œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê°’ë“¤ì„ í•œ ê³³ì— ëª¨ì•„ ë‹¤ë¥¸ ì—‘ì…€ íŒŒì¼ì— ì €ì¥í•˜ëŠ” ê²ƒì´ë‹¤.

> `output.xlsx`
> 
> | |`A`|`B`|`C`|`D`|`E`|
> |---|---|---|---|---|---|
> |`1`|a.xlsx|ë°°íŠ¸ë§¨|ë‚¨ì„±|ë°±ìˆ˜|23|
> |`2`|b.xlsx|ì—‘ìŠ¤ë§¨|ë‚¨ì„±|ì‹¸ì›€ê¾¼|38|
> |`3`|c.xlsx|ìŠˆí¼ë§¨|ë‚¨ì„±|ì˜ì›…|32|

## 2. files í´ë”ì— ì €ì¥ëœ ëª¨ë“  íŒŒì¼ëª…ì„ ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥í•œë‹¤.

ì¼ë‹¨ íŒŒì´ì¬Â osÂ ëª¨ë“ˆì„ í™œìš©í•´ì„œ í•˜ìœ„í´ë” filesì— ì €ì¥ëœÂ ëª¨ë“  íŒŒì¼ë“¤ì˜ ì´ë¦„ì„ ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥í•˜ê³  ì¶œë ¥í•˜ëŠ” ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤.

```python
import os

path = "./files"
file_list = os.listdir(path)
print(file_list)

# ['a.xlsx', 'b.xlsx', 'c.xlsx']
```

## 3. openpyxlì„ í™œìš©í•´ ì—‘ì…€ íŒŒì¼ì˜ ê°’ë“¤ì„ ë¦¬ìŠ¤íŠ¸ì˜ ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥í•œë‹¤.

[openpyxl](https://openpyxl.readthedocs.io/en/stable/)ì€ ì—‘ì…€ íŒŒì¼ì„ ì†ì‰½ê²Œ ë‹¤ë£° ìˆ˜ ìˆëŠ” íŒŒì´ì¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë‹¤. ê°€ì¥ ë„ë¦¬ ì“°ì´ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë©°, ë‹¤ë¥¸ ì—‘ì…€ ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ë³´ë‹¤ ê°€ë³ê³  í¸ë¦¬í•´ì„œ ì¢‹ë‹¤. ìì„¸í•œ ë‚´ìš©ì€ í™ˆí˜ì´ì§€ë¥¼ ì°¸ì¡°í•˜ì. ì„¤ì¹˜ëŠ” ì•„ë˜ì™€ ê°™ì€ pip ëª…ë ¹ì–´ë¡œ ì‰½ê²Œ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.

```
pip install openpyxl
```

ì´ì œ openpyxlì˜Â load_workbookì´ë¼ëŠ” ëª¨ë“ˆì„ ì´ìš©í•  ê²ƒì´ë‹¤. for ë°˜ë³µë¬¸ì„ í™œìš©í•´ ì•„ê¹Œ ì €ì¥í•œ íŒŒì¼ ì´ë¦„ì„ ì°¾ì•„ í•˜ë‚˜ì”© ì—´ê³ , ì•„ë˜ì™€ ê°™ì€ êµ¬ì²´ì ì¸ ë‹¨ê³„ë¥¼ í†µí•´Â ê°’ë“¤ì„ ë¦¬ìŠ¤íŠ¸ì˜ ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥í•œë‹¤.

1. `results`ë¼ëŠ” ì´ë¦„ì˜ ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¥¼ ìƒì„±í•œë‹¤. (ì´ê³³ì— ìµœì¢…ì ìœ¼ë¡œ ê° íŒŒì¼ì—ì„œ ìˆ˜ì§‘í•œ ê°’ë“¤ì„ ë¦¬ìŠ¤íŠ¸ì˜ í˜•íƒœë¡œ ì €ì¥í•  ê²ƒì´ë‹¤.)
2. `result`ë¼ëŠ” ì´ë¦„ì˜ ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¥¼ ìƒì„±í•œë‹¤. (í•˜ë‚˜ì˜ íŒŒì¼ì—ì„œ ìˆ˜ì§‘ëœ ê°’ì„ ë‹´ëŠ” ì„ì‹œ ì €ì¥ì†Œë¡œ í™œìš©í•œë‹¤.)
3. ê° íŒŒì¼ì„ ì—´ê³  ê·¸ íŒŒì¼ì—ì„œ ì›í•˜ëŠ” ê°’ì„ ì°¾ì•„ `result`ì— ìˆœì„œëŒ€ë¡œ ì¶”ê°€í•œë‹¤.
4. `result`ë¥¼ `results`ì— ì¶”ê°€í•œë‹¤.
5. `for` ë°˜ë³µë¬¸ì„ í™œìš©í•´ ë‹¤ìŒ íŒŒì¼ì„ ì—´ê³  ìœ„ ë‹¨ê³„ë¥¼ ë°˜ë³µí•œë‹¤.

êµ¬ì²´ì ì¸ ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

```python
from openpyxl import load_workbook

results = []

for file_name_raw in file_list:

    file_name = "./files/" + file_name_raw
    wb = load_workbook(filename=file_name, data_only=True)
    ws = wb.active

    result = []
    result.append(file_name_raw)
    result.append(ws['B1'].value)
    result.append(ws['B2'].value)
    result.append(ws['D1'].value)
    result.append(ws['D2'].value)

    results.append(result)

print(results)
```

`wb.active`ëŠ” í˜„ì¬ í™œì„±í™”ëœ ì›Œí¬ì‹œíŠ¸ë¥¼ ë§í•œë‹¤. ì—¬ê¸°ì„œ `ws['B1'].value`ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì…€B1ì˜ ê°’ì„ ì°¾ì•„ì˜¤ëŠ” ê²ƒì´ë‹¤.

ì¶œë ¥í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ ê°’ì„ ì–»ì„ ìˆ˜ ìˆë‹¤. (ë¦¬ìŠ¤íŠ¸ ì²«ë²ˆì§¸ ê°’ìœ¼ë¡œëŠ” íŒŒì¼ëª…ì„ ì¶”ê°€í–ˆë‹¤.)

```
[['a.xlsx', 'ë°°íŠ¸ë§¨', 'ë‚¨ì„±', 'ë°±ìˆ˜', 23], ['b.xlsx', 'ì—‘ìŠ¤ë§¨', 'ë‚¨ì„±', 'ì‹¸ì›€ê¾¼', 38], ['c.xlsx', 'ìŠˆí¼ë§¨', 'ë‚¨ì„±', 'ì˜ì›…', 32]]
```

## 4. ìˆ˜ì§‘í•œ ê°’ë“¤ì„ í•˜ë‚˜ì˜ ì—‘ì…€íŒŒì¼ì— ì“°ê³  ì €ì¥í•œë‹¤.

ì´ë²ˆì—”Â `Workbook`ì´ë¼ëŠ” ëª¨ë“ˆì„ í™œìš©í•œë‹¤. `ws.append()`ë¥¼ í™œìš©í•˜ë©´ í•˜ë‚˜ì˜ í–‰ì— í•˜ë‚˜ì˜ ë¦¬ìŠ¤íŠ¸ë¥¼ ì¶”ê°€í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

```python
from openpyxl import Workbook

wb = Workbook()
ws = wb.active

for i in results:
    ws.append(i)

wb.save("output.xlsx")
```

ìœ„ì— ë‚˜ì—´ëœ ì½”ë“œ ë¬¶ìŒ ì„¸ ê°œë¥¼ ì´ì–´ì„œ ì‹¤í–‰í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ output.xlsxë¼ëŠ” ì—‘ì…€ íŒŒì¼ì´ ìƒì„±ë˜ê³  ê·¸ ì•ˆì— ê°’ì´ ì •ë¦¬ë˜ì–´ ìˆìŒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì§ !

> `output.xlsx`
> 
> | |`A`|`B`|`C`|`D`|`E`|
> |---|---|---|---|---|---|
> |`1`|a.xlsx|ë°°íŠ¸ë§¨|ë‚¨ì„±|ë°±ìˆ˜|23|
> |`2`|b.xlsx|ì—‘ìŠ¤ë§¨|ë‚¨ì„±|ì‹¸ì›€ê¾¼|38|
> |`3`|c.xlsx|ìŠˆí¼ë§¨|ë‚¨ì„±|ì˜ì›…|32|

## íŒŒì´ì¬ ì½”ë“œ ì˜ˆì‹œ (ì „ì²´)

```python
import os

path = "./files"
file_list = os.listdir(path)
print(file_list)


from openpyxl import load_workbook

results = []

for file_name_raw in file_list:

    file_name = "./files/" + file_name_raw
    wb = load_workbook(filename=file_name, data_only=True)
    ws = wb.active

    result = []
    result.append(file_name_raw)
    result.append(ws['B1'].value)
    result.append(ws['B2'].value)
    result.append(ws['D1'].value)
    result.append(ws['D2'].value)

    results.append(result)

print(results)


from openpyxl import Workbook
wb = Workbook()
ws = wb.active

for i in results:
    ws.append(i)

wb.save("output.xlsx")
```

ì•„ë¬´íŠ¼ íŒŒì´ì¬ì„ ì˜ ì“°ë©´ ì¼ì´ í¸í•´ì§„ë‹¤.