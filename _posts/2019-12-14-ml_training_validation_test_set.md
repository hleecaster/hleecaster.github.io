---
title: λ¨Έμ‹ λ¬λ‹ κ³µλ¶€ - ν•™μµμ„ΈνΈ, ν‰κ°€μ„ΈνΈλ¥Ό λ‚λ„λ” μ΄μ μ™€ λ°©λ²•
date: 2019-12-14
categories: [WORK, π“ Data]
tags: [λ°μ΄ν„°λ¶„μ„, MachineLearning, Python]
---

μ°λ¦¬λ” λ¨Έμ‹ λ¬λ‹μ„ ν†µν•΄μ„ μμΈ΅μ΄λ‚ λ¶„λ¥λ¥Ό ν•  μ μλ‹¤. κ·Έλ°λ° μ΄ μμΈ΅μ΄λ‚ λ¶„λ¥κ°€ μ–Όλ§λ‚ μ •ν™•ν•μ§€ μλ¬Έν•λ” κ²ƒμ΄ μ¤‘μ”ν•λ‹¤. λ¶„λ¥ λ¨λΈμ„ λ§λ“¤μ–΄λ†¨λ”λ°, κ·Έ μμΈ΅μ΄ μ–Όλ§λ‚ λ§κ³  ν‹€λ¦΄μ§€ λ¨λ¥΄λ‹κΉ.

μ§€λ„ν•™μµ(supervised learning)μ—μ„λ” λ‹¤ν–‰νλ„ μ΄λ―Έ λ μ΄λΈ”λ§ λ(μ •λ‹µμ΄ μλ”) λ°μ΄ν„°κ°€ μκΈ° λ•λ¬Έμ— κ·Έκ±Έ ν™μ©ν•΄μ„ μ•κ³ λ¦¬μ¦μ μ •ν™•λ„λ¥Ό ν…μ¤νΈ ν•  μ μλ‹¤.

λ¨Έμ‹ λ¬λ‹ λ¨λΈμ ν¨κ³Όμ„±μ„ κ²€μ¦ν•κΈ° μ„ν•΄ λ°μ΄ν„°λ¥Ό λ‚λ λ• λ³΄ν†µ μ•„λμ™€ κ°™μ΄ μ„Έ κ°μ κ°λ…μ„ μ΄ν•΄ν•λ©΄ λλ‹¤.

- Training Set (ν•™μµ μ„ΈνΈ)
- Validation Set (κ²€μ¦ μ„ΈνΈ)
- Test Set (ν‰κ°€ μ„ΈνΈ)

μ΄ μ¤‘ κ²€μ¦ μ„ΈνΈμ™€ ν‰κ°€ μ„ΈνΈλ” μ‚¬μ‹¤ μ μ‚¬ν• κ°λ…μ΄λ‹¤.

## ν•™μµ μ„ΈνΈ(Training Set)μ™€ κ²€μ¦ μ„ΈνΈ(Validation Set)

ν•™μµ μ„ΈνΈ(Training Set)λ” λ­ λ§ κ·Έλ€λ΅Β μ•κ³ λ¦¬μ¦μ΄ ν•™μµν•  λ°μ΄ν„°λ‹¤.

μ΄ ν•™μµ λ°μ΄ν„° μ„ΈνΈλ¥Ό μ‚¬μ©ν•μ—¬ λ¨λΈμ„ ν•™μµμ‹ν‚¤κ³  λ‚λ©΄ μ΄ν›„μ—λ”Β κ²€μ¦ μ„ΈνΈ(Validation Set)λ¥Ό ν†µν•΄ λ¨λΈμ μμΈ΅/λ¶„λ¥ μ •ν™•λ„λ¥Ό κ³„μ‚°ν•  μ μλ‹¤. μ‚¬μ‹¤ λ¨λ“  κ²€μ¦ μ„ΈνΈμ— λ€ν•Β μ‹¤μ  λ μ΄λΈ”, μ¦‰ μ •λ‹µμ„ μ•κ³  μμ§€λ§ κ·Έλ ‡μ§€ μ•μ€ μ²™Β ν•λ” μ…μ΄λ‹¤. κ·Έλμ„ μƒλ΅μ΄ λ°μ΄ν„°μΈ κ²ƒμ²λΌ λ¶„λ¥/μμΈ΅ λ¨λΈμ— μ…λ ¥ν•΄μ¤€λ‹¤. μ‹¤μ λ΅ ν•™μµ μ‹ν‚¬ λ• μ΄ λ°μ΄ν„°λ“¤μ„ λ°°μ ν–κΈ° λ•λ¬Έμ— κ°€λ¥ν•λ‹¤. μμΈ΅/λ¶„λ¥λ κ°’μ„ λ°›μ•„μ„ μ‹¤μ λ΅ κ°–κ³  μλ λ‹µκ³Ό λΉ„κµν•κΈ°λ§ ν•λ©΄ κ²°κµ­Β μ •ν™•λ„(Accuracy)λ¥Ό μ• μ μλ” κ±°λ‹¤.

λ¬Όλ΅  μ—¬κΈ°μ„ λ§ν•λ”Β μ •ν™•λ„(Accuracy)κ°€ λ§λ¥μ μ§€ν‘λ” μ•„λ‹λ‹¤. λ¨Έμ‹ λ¬λ‹ μ•κ³ λ¦¬μ¦μ ν¨κ³Όλ¥Ό νλ‹¨ν•  λ• μ¤νλ ¤Β μ •λ°€λ„(precision)κ³ΌΒ μ¬ν„μ¨(recall), κ·Έλ¦¬κ³  μ •ν™•λ¥ κ³Ό μ •λ°€λ„μ μ΅°ν™”ν‰κ· μΈΒ F1 μ μλ¥Ό ν™•μΈν•λ” λ“±μ λ°©λ²•λ„ μλ‹¤. μ΄λ° μ§€ν‘λ“¤μ— λ€ν•΄μ„λ” λ‚μ¤‘μ— λ κΈ°νκ°€ λλ©΄ ν¬μ¤ν… ν•κ² λ‹¤. μΌλ‹¨ λ„μ–΄κ°€μ.

## μ–΄λ–»κ² λ°μ΄ν„° μ„ΈνΈλ¥Ό λ‚λ κ²ƒμΈκ°€ (How to Split)

ν•™μµμ„ΈνΈ vs κ²€μ¦μ„ΈνΈλ¥Ό μ–΄λ–¤ λΉ„μ¨λ΅ λ¶„ν• ν• μ§€ νλ‹¨ν•κΈ°κ°€ μ‰½μ§€ μ•λ‹¤. ν•™μµ μ„ΈνΈκ°€ λ„λ¬΄ μ‘μΌλ©΄ μ•κ³ λ¦¬μ¦μ΄ ν¨κ³Όμ μΌλ΅ ν•™μµν•κΈ°μ— μ¶©λ¶„μΉ μ•μ„ μ μλ‹¤. λ°λ©΄, κ²€μ¦ λ°μ΄ν„°κ°€ λ„λ¬΄ μ‘μΌλ©΄ μ΄λ¥Ό ν†µν•΄ κ³„μ‚°ν• μ •ν™•λ„(Accuracy), μ •λ°€λ„(precision), μ¬ν„μ¨(recall), F1 μ μκ°€ μ„λ΅ μ°¨μ΄κ°€ λ§μ΄ λ‚μ„ μ‹ λΆ°ν•κΈ° μ–΄λ ¤μΈ μ μλ‹¤.

μΌλ°μ μΌλ΅Β μ „μ²΄ λ°μ΄ν„° μ¤‘ 80%λ¥Ό ν•™μµμΌλ΅, 20%λ¥Ό κ²€μ¦μΌλ΅ μ‚¬μ©ν•λ” κ²ƒμ΄ μΆ‹λ‹¤κ³  ν•λ‹¤.

λ‚λ„λ” λ°©λ²•μ€ scikit-learnμ—μ„ μΉμ ν•κ² μ κ³µν•λ‹¤.

```python
from sklearn.model_selection import train_test_split

training_data, validation_data , training_labels, validation_labels = train_test_split(x, y, train_size=0.8, test_size=0.2)
```

## κµμ°¨ κ²€μ¦ (N-Fold Cross-Validation)

λ°μ΄ν„°κ°€ μ¶©λ¶„μΉ μ•μ„ κ²½μ° 80/20μΌλ΅ λ‚λ„λ©΄ μ—¬μ „ν λ§μ€ μ–‘μ λ¶„μ‚°μ΄ λ°μƒν•λ‹¤. μ΄μ— λ€ν• ν• κ°€μ§€ ν•΄κ²°μ±…μ€Β N-Fold κµμ°¨ κ²€μ¦μ„ μν–‰ν•λ” κ²ƒ, μ¦‰Β μ „μ²΄ ν”„λ΅μ„Έμ¤λ¥Ό Nλ² μν–‰ν•κ³  λ¨λ“  μν–‰μ—μ„ λ‚μ¨ μ •ν™•λ„μ ν‰κ· μ„ κµ¬ν•λ” λ°©λ²•μ΄λ‹¤.

λ‹Ήμ—°ν μ΄λ ‡κ² κµ¬ν• μ •ν™•λ„μ ν‰κ·  κ°’μ΄ μ•„λ¬΄λλ„ λ¨λΈμ ν‰κ·  μ„±λ¥μ„ λ” μ λ‚νƒ€λ‚Έλ‹¤κ³  λ³Ό μ μλ‹¤.

κ·Έλ¦¬κ³  μ΄κ±Έ μΌμΌμ΄ ν•κΈ° κ·€μ°®μΌλ‹ scikit-learnμ—μ„λ” μ•„μ μ΄λ° κΈ°λ¥μ„ μ κ³µν•κ³  μκΈ°λ„ ν•λ‹¤.

```python
from sklearn.model_selection import KFold
```

κ·Έλ¬λ‹ μ κ·Ήμ μΌλ΅ μ‚¬μ©ν•μ.

## λ¨λΈ μ„±λ¥ κ°μ„  λ° ν‰κ°€ μ„ΈνΈ(Test Set)

λ¨λΈμ νλΌλ―Έν„°λ¥Ό μ„Έλ¶€μ μΌλ΅ νλ‹ν•λ©΄ κ·Έ λ¨λΈμ μ„±λ¥μ„ ν–¥μƒμ‹ν‚¬ μ μλ‹¤. μλ¥Ό λ“¤μ–΄, K-μµκ·Όμ ‘ μ΄μ›ƒ(K-Nearest Neighbors) μ•κ³ λ¦¬μ¦μ—μ„λ” Kλ¥Ό λλ¦¬κ±°λ‚ μ¤„μΌ λ• μ •ν™•λ„κ°€ μ–΄λ–»κ² λ‹¬λΌμ§€λ”μ§€ ν™•μΈν•  μ μλ‹¤.

λ§μ•½ λ¨λΈμ μ„±λ¥μ΄ μ–΄λμ •λ„ λ§μ΅±μ¤λ½λ‹¤λ©΄Β ν‰κ°€ μ„ΈνΈ(Test Set)λ¥Ό λ„£μ–΄λ³Ό μ μλ‹¤. μ΄κ±΄Β μ‹¤μ  λ°μ΄ν„°λ‹¤. μ–΄λ–¤ μμΈ΅/λ¶„λ¥κ°€ μΌμ–΄λ‚ μ§€ κ¶κΈν• κ°’μ„ λ§λ“¤μ–΄ λ„£μ–΄μ¤„ μλ„ μκ³ , μƒλ΅­κ² μ–»μ€ λ°μ΄ν„°μΌ μλ„ μμΌλ©°, μ• μ΄μ— λ¨λΈμ„ μƒμ„±ν•κΈ° μ „μ— μΌλ¶€λ¬ λ”°λ΅ λ–Όμ–΄λ†“μ€ λ°μ΄ν„°μΌ μλ„ μλ‹¤. μ–΄λ–»κ² λ³΄λ©΄Β κ²€μ¦ μ„ΈνΈ(Validation Set)μ™€ λΉ„μ·ν•μ§€λ§, λ¨λΈμ„ κµ¬μ¶•ν•κ±°λ‚ νλ‹ν•  λ• ν¬ν•¨λ μ  μ—†λ‹¤λ” μ μ—μ„ μ°¨μ΄κ°€ μλ‹¤.

μ•„λ¬΄νΌ μ΄ ν‰κ°€ μ„ΈνΈ(Test Set)μ—μ„ λ¨λΈμ΄ μμΈ΅/λ¶„λ¥ν•΄μ¤€ κ°’κ³Ό μ‹¤μ  κ°’μ„ λΉ„κµν•΄μ„ μ •ν™•λ„(Accuracy), μ •λ°€λ„(precision), μ¬ν„μ¨(recall), F1 μ μλ¥Ό κ³„μ‚°ν•΄λ΄„μΌλ΅μ¨Β μ•κ³ λ¦¬μ¦μ΄ ν„μ‹¤ μ„Έκ³„μ—μ„ μ–Όλ§λ‚ μ μν–‰λλ”μ§€Β μ΄ν•΄ν•  μ μκ² λλ” κ±°λ‹¤.