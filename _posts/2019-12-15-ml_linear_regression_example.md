---
title: ë¨¸ì‹ ëŸ¬ë‹ ê³µë¶€ - ì„ í˜•íšŒê·€(Linear Regression) íŒŒì´ì¬ ì½”ë“œ ì˜ˆì‹œ
date: 2019-12-15
categories: [WORK, ğŸ“Š Data]
tags: [ë°ì´í„°ë¶„ì„, MachineLearning, Python]
---

ë³¸ í¬ìŠ¤íŒ…ì—ì„œëŠ” íŒŒì´ì¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ scikit-learnì„ í†µí•´ ì„ í˜•íšŒê·€(Linear Regression) ë¶„ì„ì„ ì§ì ‘ ìˆ˜í–‰í•˜ëŠ” ì˜ˆì‹œë¥¼ ì†Œê°œí•œë‹¤. ëˆ„êµ¬ë‚˜ ì‰½ê²Œ ë”°ë¼í•  ìˆ˜ ìˆëŠ” ìˆ˜ì¤€ìœ¼ë¡œ ì‘ì„±í–ˆë‹¤.

## sklearn LinearRegression ì‚¬ìš©ë²•

ì‹¤ì œ ë°ì´í„° ëŒë ¤ë³´ê¸° ì „ì— ì‚¬ìš©ë²•ë¶€í„° ìµíˆê³  ê°€ì.

ì¼ë‹¨ íŒŒì´ì¬ ë¨¸ì‹ ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‹¸ì´í‚·ëŸ°ì„ ë¶ˆëŸ¬ì˜¤ì.

```python
from sklearn.linear_model import LinearRegression
```

ì´ì œÂ `LinearRegression`Â ëª¨ë¸ì„ ìƒì„±í•˜ê³ , ê·¸ ì•ˆì— X, y ë°ì´í„°ë¥¼ fit ì‹œí‚¨ë‹¤. ì´ë ‡ê²Œ.

```python
line_fitter = LinearRegression()
line_fitter.fit(X, y)
```

`fit()`Â ë©”ì„œë“œëŠ” ì„ í˜• íšŒê·€ ëª¨ë¸ì— í•„ìš”í•œ ë‘ ê°€ì§€ ë³€ìˆ˜ë¥¼ ì „ë‹¬í•˜ëŠ” ê±°ë‹¤.

- ê¸°ìš¸ê¸°:Â `line_fitter.coef_`
- ì ˆí¸:Â `line_fitter.intercept_`

ì–´ì¨Œë“  ì´ê²Œ ëì´ë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ìƒˆë¡œìš´Â `X`Â ê°’ì„ ë„£ì–´ `y`ê°’ì„ ì˜ˆì¸¡í•  ìˆ˜ ìˆê²Œ ëœë‹¤.

```python
y_predicted = line_fitter.predict(X)
```

ë§Œì•½ ê¸°ìš¸ê¸°ì™€ ì ˆí¸ì„ ì•Œê³  ì‹¶ë‹¤ë©´Â `line_fitter.coef_`Â ,Â `line_fitter.intercept_`ë¥¼ ì§ì ‘ ì°ì–´ë³´ë©´ ëœë‹¤.

ì‰½ë‹¤.

ì•„, ê·¸ë¦¬ê³ Â ìˆ˜ë ´í•  ë•Œê¹Œì§€ ì–¼ë§ˆë‚˜ ë°˜ë³µí•  ê²ƒì¸ì§€(`num_iterations`), ì–¼ë§ˆë‚˜ ê¼¼ê¼¼íˆ í•™ìŠµí•  ê²ƒì¸ì§€(`learning_rate`) ì´ëŸ° ê²ƒë“¤ì„ ì •í•´ì¤„ ìˆ˜ë„ ìˆëŠ”ë°, ì—¬ê¸°ì„œëŠ” êµ³ì´ ë³µì¡í•˜ê²Œ ê³ ë ¤í•˜ì§€ ì•Šì•„ë„ ê´œì°®ë‹¤. ì‹¸ì´í‚·ëŸ° ë‹¨ìˆœ ì„ í˜•íšŒê·€ì—ì„œëŠ”Â [ìµœì†Œì œê³±ë²•(Ordinary Least Squares)](https://ko.wikipedia.org/wiki/%EC%B5%9C%EC%86%8C%EC%A0%9C%EA%B3%B1%EB%B2%95)ì„ í™œìš©í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

## sklearn LinearRegression ì‹¤ì „ ì˜ˆì‹œ

ì¼ë‹¨ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤.

sklearn ì™¸ì—ë„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ë•Œ í•„ìš”í•œ pandas, ë°°ì—´ì„ ë°”ê¿€ ë•Œ í•„ìš”í•œ numpy, ì‹œê°í™”ë¥¼ ìœ„í•œ matplotlibë¥¼ í•¨ê»˜ ë¶ˆëŸ¬ì™”ë‹¤.

```python
from sklearn.linear_model import LinearRegression
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
```

ì¼ë‹¨ ë‚˜ëŠ” csv íŒŒì¼ë¡œ í‚¤ì™€ ëª¸ë¬´ê²Œê°€ ë“¤ì–´ìˆëŠ” íŒŒì¼ì„ ì¤€ë¹„í–ˆë‹¤. ([ë°ì´í„° ë‹¤ìš´ë¡œë“œ](https://www.kaggle.com/datasets/burnoutminer/heights-and-weights-dataset))

pandasë¡œ ìœ— ë¶€ë¶„ë§Œ ì°ì–´ë³´ê³ ,

```python
df = pd.read_csv("./SOCR-HeightWeight.csv")
df.head()
```

matplotlibìœ¼ë¡œ ì‹œê°í™”ë¥¼ í•´ë³´ë‹ˆ ëŒ€ì¶© ìš°ìƒí–¥ í•˜ëŠ” íŒ¨í„´ì´ ë³´ì¸ë‹¤.

```python
X = df["Height(Inches)"]
y = df["Weight(Pounds)"]
plt.plot(X, y, 'o')
plt.show()
```

ì´ì œ ìœ„ì—ì„œ ë°°ìš´ëŒ€ë¡œ ëª¨ë¸ì„ ìƒì„±í•˜ê³  ë°ì´í„°ë¥¼ fit ì‹œí‚¨ë‹¤.

```python
line_fitter = LinearRegression()
line_fitter.fit(X.values.reshape(-1,1), y)
```

ì—¬ê¸°ì„œ ì£¼ì˜í•´ì•¼ í•  ì ì€Â `X`ë°ì´í„°ë¥¼ ë„£ì„ ë•ŒÂ `.values.reshape(-1,1)`ë¥¼ í•´ì¤¬ë‹¤ëŠ” ê±°ë‹¤. ì™œëƒí•˜ë©´Â XëŠ” 2ì°¨ì› array í˜•íƒœì—¬ì•¼ í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ì´ëŸ° ì‹ìœ¼ë¡œÂ `[[x1], [x2], [x3], ... , [xn]]`Â . (ì´ë ‡ê²Œ ë„£ëŠ” ì´ìœ ëŠ” X ë³€ìˆ˜ê°€ í•˜ë‚˜ê°€ ì•„ë‹ˆë¼ ì—¬ëŸ¬ê°œì¼ ë•Œ ë‹¤ì¤‘íšŒê·€ë¶„ì„ì„ ì‹¤ì‹œí•˜ê¸° ìœ„í•¨ì¸ë°, ì´ëŠ”Â ë‹¤ë¥¸ ê¸€ì—ì„œ ì†Œê°œí•´ì•¼ê² ë‹¤.)

ì•„ë¬´íŠ¼ ì´ë ‡ê²Œ í•˜ë©´ ëì´ë‹¤.

ì´ì œ í•œ ë²ˆÂ ì˜ˆì¸¡ì„ í•´ë³´ì. í‚¤ê°€ 70ì¸ì¹˜ì¸ ì‚¬ëŒì„ ì˜ˆì¸¡í•œë‹¤ê³  ì¹˜ë©´ ì´ë ‡ê²Œ.

```python
line_fitter.predict([[70]])
```

133.26760811ë¥¼ ëŒë ¤ì¤€ë‹¤. ëª¸ë¬´ê²Œê°€ 133íŒŒìš´ë“œ ì •ë„ ë˜ë‚˜ë³´ë‹¤.

ê·¸ë ‡ë‹¤ë©´Â ê¸°ìš¸ê¸°ë¥¼ ì•Œë ¤ë‹¬ë¼ê³  í•´ë³´ì.

```python
line_fitter.coef_
```

3.08347645ë¥¼ ëŒë ¤ì¤€ë‹¤.

ì´ë²ˆì—” ì ˆí¸ì„ ì•Œë ¤ë‹¬ë¼ê³  í•´ë³´ì.

```python
line_fitter.intercept_
```

-82.57574306454093ë¼ê³  í•œë‹¤.

ì´ë²ˆì—” ê¸°ì¡´ X ê°’ìœ¼ë¡œ yë¥¼ ì˜ˆì¸¡í•˜ê²Œ í•´ì„œ ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ë³´ì. ë‹¹ì—°íˆ ì„ ì´ ë‚˜ì˜¬ ê±°ë‹¤.

```python
plt.plot(X, y, 'o')
plt.plot(X,line_fitter.predict(X.values.reshape(-1,1)))
plt.show()
```

ì˜ˆì‹œëŠ” ì—¬ê¸°ê¹Œì§€.